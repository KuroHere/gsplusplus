/*
 * Decompiled with CFR 0.152.
 */
package com.gamesense.client.module.modules.exploits;

import com.gamesense.api.event.Phase;
import com.gamesense.api.event.events.OnUpdateWalkingPlayerEvent;
import com.gamesense.api.setting.values.BooleanSetting;
import com.gamesense.api.setting.values.IntegerSetting;
import com.gamesense.api.util.player.InventoryUtil;
import com.gamesense.api.util.player.PlacementUtil;
import com.gamesense.api.util.player.PlayerPacket;
import com.gamesense.api.util.world.BlockUtil;
import com.gamesense.client.manager.managers.PlayerPacketManager;
import com.gamesense.client.module.Category;
import com.gamesense.client.module.Module;
import com.mojang.realmsclient.gui.ChatFormatting;
import java.util.function.Predicate;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.block.BlockAir;
import net.minecraft.block.BlockHopper;
import net.minecraft.block.BlockShulkerBox;
import net.minecraft.client.gui.inventory.GuiCrafting;
import net.minecraft.entity.Entity;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.init.Blocks;
import net.minecraft.init.Items;
import net.minecraft.inventory.ClickType;
import net.minecraft.item.ItemBlock;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketEntityAction;
import net.minecraft.util.EnumFacing;
import net.minecraft.util.EnumHand;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.Vec2f;
import net.minecraft.util.math.Vec3d;
import net.minecraft.util.math.Vec3i;

@Module.Declaration(name="AutoDupe5b", category=Category.Exploits)
public class AutoDupe5b
extends Module {
    BooleanSetting hopperCheck = this.registerBoolean("Hopper Check", true);
    IntegerSetting itemCrafting = this.registerInteger("Item Crafting", 15, 0, 100);
    IntegerSetting maxStackWait = this.registerInteger("Max Stack Wait", 20, 0, 100);
    IntegerSetting waitPlace = this.registerInteger("Wait Place", 20, 0, 100);
    Vec3d lastHitVec = null;
    BlockPos shulkerPos;
    BlockPos wbPos;
    int slotPick;
    int slotShulk;
    int stage;
    int slotWood;
    int tickPutItem;
    boolean beforePlaced;
    @EventHandler
    private final Listener<OnUpdateWalkingPlayerEvent> onUpdateWalkingPlayerEventListener = new Listener<OnUpdateWalkingPlayerEvent>(event -> {
        if (event.getPhase() != Phase.PRE || this.lastHitVec == null) {
            return;
        }
        PlayerPacketManager.INSTANCE.addPacket(new PlayerPacket((Module)this, new Vec2f(0.0f, -90.0f)));
    }, new Predicate[0]);

    @Override
    public void onEnable() {
        if (AutoDupe5b.mc.field_71441_e == null || AutoDupe5b.mc.field_71439_g == null) {
            this.disable();
            return;
        }
        this.initValues();
    }

    private void initValues() {
        this.wbPos = new BlockPos(AutoDupe5b.mc.field_71439_g.field_70165_t, AutoDupe5b.mc.field_71439_g.field_70163_u, AutoDupe5b.mc.field_71439_g.field_70161_v).func_177963_a(0.5, -1.0, 0.5);
        this.shulkerPos = null;
        for (Vec3d surround : new Vec3d[]{new Vec3d(1.0, -2.0, 0.0), new Vec3d(-1.0, -2.0, 0.0), new Vec3d(0.0, -2.0, 1.0), new Vec3d(0.0, -2.0, -1.0)}) {
            BlockPos pos;
            if (((Boolean)this.hopperCheck.getValue()).booleanValue()) {
                pos = new BlockPos(AutoDupe5b.mc.field_71439_g.field_70165_t + surround.field_72450_a, AutoDupe5b.mc.field_71439_g.field_70163_u + surround.field_72448_b, AutoDupe5b.mc.field_71439_g.field_70161_v + surround.field_72449_c);
                if (!(BlockUtil.getBlock(pos) instanceof BlockHopper)) continue;
                this.shulkerPos = new BlockPos(AutoDupe5b.mc.field_71439_g.field_70165_t + surround.field_72450_a, AutoDupe5b.mc.field_71439_g.field_70163_u, AutoDupe5b.mc.field_71439_g.field_70161_v + surround.field_72449_c);
                break;
            }
            pos = new BlockPos(AutoDupe5b.mc.field_71439_g.field_70165_t + surround.field_72450_a, AutoDupe5b.mc.field_71439_g.field_70163_u, AutoDupe5b.mc.field_71439_g.field_70161_v + surround.field_72449_c);
            if (!(BlockUtil.getBlock(pos) instanceof BlockAir)) continue;
            this.shulkerPos = pos;
            break;
        }
        if (this.shulkerPos == null) {
            this.disable();
            return;
        }
        this.slotPick = InventoryUtil.findFirstItemSlot(Items.field_151046_w.getClass(), 0, 8);
        if (this.slotPick == -1) {
            this.disable();
            return;
        }
        this.slotWood = InventoryUtil.findFirstBlockSlot(Blocks.field_150344_f.getClass(), 0, 35);
        if (this.slotWood == -1) {
            this.disable();
            return;
        }
        this.slotShulk = InventoryUtil.findFirstShulker(0, 8);
        if (this.slotShulk == -1) {
            this.disable();
            return;
        }
        this.stage = 0;
    }

    @Override
    public void onDisable() {
    }

    @Override
    public void onUpdate() {
        switch (this.stage) {
            case 0: {
                if (AutoDupe5b.mc.field_71439_g.field_71071_by.func_70301_a(this.slotShulk + 36).func_190926_b()) {
                    this.slotShulk = InventoryUtil.findFirstShulker(0, 8);
                    if (this.slotShulk == -1) {
                        this.disable();
                        return;
                    }
                }
                AutoDupe5b.mc.field_71442_b.func_187098_a(0, this.slotShulk + 36, 0, ClickType.THROW, (EntityPlayer)AutoDupe5b.mc.field_71439_g);
                if (AutoDupe5b.mc.field_71439_g.func_70093_af()) {
                    AutoDupe5b.mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketEntityAction((Entity)AutoDupe5b.mc.field_71439_g, CPacketEntityAction.Action.STOP_SNEAKING));
                }
                AutoDupe5b.mc.field_71442_b.func_187099_a(AutoDupe5b.mc.field_71439_g, AutoDupe5b.mc.field_71441_e, this.wbPos, EnumFacing.UP, new Vec3d((Vec3i)this.wbPos), EnumHand.MAIN_HAND);
                if (AutoDupe5b.mc.field_71439_g.func_70093_af()) {
                    AutoDupe5b.mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketEntityAction((Entity)AutoDupe5b.mc.field_71439_g, CPacketEntityAction.Action.START_SNEAKING));
                }
                this.stage = 1;
                this.tickPutItem = 0;
                break;
            }
            case 1: {
                if (!(AutoDupe5b.mc.field_71462_r instanceof GuiCrafting) || this.tickPutItem++ < (Integer)this.itemCrafting.getValue()) break;
                AutoDupe5b.mc.field_71442_b.func_187098_a(AutoDupe5b.mc.field_71439_g.field_71070_bA.field_75152_c, this.slotWood < 9 ? this.slotWood + 37 : this.slotWood + 1, 1, ClickType.PICKUP, (EntityPlayer)AutoDupe5b.mc.field_71439_g);
                AutoDupe5b.mc.field_71442_b.func_187098_a(AutoDupe5b.mc.field_71439_g.field_71070_bA.field_75152_c, 1, 0, ClickType.PICKUP, (EntityPlayer)AutoDupe5b.mc.field_71439_g);
                AutoDupe5b.mc.field_71442_b.func_78765_e();
                this.stage = 2;
                this.tickPutItem = 0;
                break;
            }
            case 2: {
                for (int i = 0; i < 9; ++i) {
                    if (!(AutoDupe5b.mc.field_71439_g.field_71071_by.func_70301_a(i).func_77973_b() instanceof ItemBlock) || !(((ItemBlock)AutoDupe5b.mc.field_71439_g.field_71071_by.func_70301_a(i).func_77973_b()).func_179223_d() instanceof BlockShulkerBox) || AutoDupe5b.mc.field_71439_g.field_71071_by.func_70301_a(i).func_190916_E() <= 1) continue;
                    AutoDupe5b.mc.field_71439_g.func_71053_j();
                    AutoDupe5b.mc.field_71439_g.field_71071_by.field_70461_c = i;
                    if (!AutoDupe5b.mc.field_71439_g.func_70093_af()) {
                        AutoDupe5b.mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketEntityAction((Entity)AutoDupe5b.mc.field_71439_g, CPacketEntityAction.Action.START_SNEAKING));
                    }
                    PlacementUtil.place(this.shulkerPos, EnumHand.MAIN_HAND, false);
                    if (!AutoDupe5b.mc.field_71439_g.func_70093_af()) {
                        AutoDupe5b.mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketEntityAction((Entity)AutoDupe5b.mc.field_71439_g, CPacketEntityAction.Action.STOP_SNEAKING));
                    }
                    this.stage = 3;
                    this.tickPutItem = 0;
                    this.beforePlaced = false;
                    break;
                }
                if (this.tickPutItem++ <= (Integer)this.maxStackWait.getValue()) break;
                this.stage = 0;
                AutoDupe5b.mc.field_71439_g.func_71053_j();
                this.tickPutItem = 0;
                break;
            }
            case 3: {
                if (BlockUtil.getBlock(this.shulkerPos) instanceof BlockShulkerBox) {
                    this.beforePlaced = true;
                    AutoDupe5b.mc.field_71439_g.field_71071_by.field_70461_c = this.slotPick;
                    AutoDupe5b.mc.field_71439_g.func_184609_a(EnumHand.MAIN_HAND);
                    AutoDupe5b.mc.field_71442_b.func_180512_c(this.shulkerPos, EnumFacing.UP);
                    break;
                }
                if (!this.beforePlaced && this.tickPutItem++ <= (Integer)this.waitPlace.getValue()) break;
                this.stage = 0;
            }
        }
    }

    @Override
    public String getHudInfo() {
        String t = "";
        String temp = "";
        switch (this.stage) {
            case 0: {
                temp = "Dropping shulker";
                break;
            }
            case 1: {
                temp = "Crafting button";
                break;
            }
            case 2: {
                temp = "Waiting the shulker";
                break;
            }
            case 3: {
                temp = "Breaking the shulker";
            }
        }
        if (!temp.equalsIgnoreCase("")) {
            t = "[" + ChatFormatting.WHITE + temp + ChatFormatting.GRAY + "]";
        }
        return t;
    }
}

